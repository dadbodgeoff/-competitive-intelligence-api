graph TB
    subgraph "Frontend - React + TypeScript"
        A[User Uploads PDF]
        B[Custom Hook<br/>Manages State]
        C[Real-Time Progress<br/>SSE Stream]
        D[Editable Table<br/>Review Data]
    end
    
    subgraph "API Layer - FastAPI"
        E[JWT Auth<br/>Middleware]
        F[File Upload<br/>Endpoint]
        G[Streaming Parse<br/>Endpoint]
        H[Save Invoice<br/>Endpoint]
    end
    
    subgraph "Processing - Python Services"
        I[Supabase Storage<br/>File Upload]
        J[Gemini AI<br/>PDF â†’ JSON]
        K[Auto-Correction<br/>Fix Errors]
        L[Validation<br/>Business Rules]
    end
    
    subgraph "Inventory - Event Driven"
        M[Fuzzy Matcher<br/>Link Items]
        N[Create Vendors<br/>& Items]
        O[Record Transactions<br/>Audit Trail]
        P[Track Prices<br/>Detect Anomalies]
    end
    
    subgraph "Database - PostgreSQL"
        Q[(Invoices<br/>Items<br/>Vendors<br/>Inventory<br/>Transactions)]
    end
    
    A --> B
    B --> F
    F --> E
    E --> I
    I --> G
    G --> J
    J --> C
    C --> D
    J --> K
    K --> L
    L --> D
    D --> H
    H --> Q
    H --> M
    M --> N
    N --> O
    O --> P
    P --> Q
    
    style A fill:#a8e6cf
    style C fill:#ffd3b6
    style J fill:#ffaaa5
    style M fill:#ff8b94
    style Q fill:#c7ceea
