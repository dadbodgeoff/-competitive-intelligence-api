```mermaid
%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#10B981','primaryTextColor':'#fff','primaryBorderColor':'#059669','lineColor':'#6366F1','secondaryColor':'#3B82F6','tertiaryColor':'#F59E0B','fontSize':'14px'}}}%%

graph TB
    subgraph Client["ðŸ–¥ï¸ CLIENT - Instant"]
        A[Enter Location]
        B[SSE Stream]
    end
    
    subgraph Security["ðŸ”’ SECURITY - 300ms"]
        D[HTTPOnly Cookies]
        E[Row Level Security]
    end
    
    subgraph Discovery["ðŸ” DISCOVERY - 5-10s"]
        G[Google Places API]
        H[Find 5 Competitors]
        I[Auto-Select Top 2]
    end
    
    subgraph AI["ðŸ¤– AI PARSING - 16-20s"]
        J[Gemini 2.0 Flash]
        K[Parse 2 Menus: 8-9s each]
        L[Extract 15-20 Items]
    end
    
    subgraph LLM["ðŸ’¡ INSIGHTS - 8-11s"]
        M[Compare Menus]
        N[Pricing Gaps]
        O[Generate 5-7 Insights]
    end
    
    subgraph Database["ðŸ’¾ SOURCE OF TRUTH - 500ms"]
        Q[Store Competitors]
        R[Store Snapshots]
        S[Store Insights]
    end
    
    A --> D
    D --> E
    E --> G
    G --> H
    H --> I
    I --> Q
    Q --> B
    B --> J
    J --> K
    K --> L
    L --> M
    M --> N
    N --> O
    O --> S
    S --> R
    
    Result[["âœ¨ COMPLETE<br/>~30s total | $0.004 cost<br/>2 Menus + 6 Insights"]]
    R --> Result
    
    style Client fill:#4F46E5,stroke:#4338CA,stroke-width:3px,color:#fff
    style Security fill:#EF4444,stroke:#DC2626,stroke-width:3px,color:#fff
    style Discovery fill:#06B6D4,stroke:#0891B2,stroke-width:3px,color:#fff
    style AI fill:#10B981,stroke:#059669,stroke-width:3px,color:#fff
    style LLM fill:#F59E0B,stroke:#D97706,stroke-width:3px,color:#fff
    style Database fill:#3B82F6,stroke:#2563EB,stroke-width:3px,color:#fff
    style Result fill:#8B5CF6,stroke:#7C3AED,stroke-width:4px,color:#fff
```
